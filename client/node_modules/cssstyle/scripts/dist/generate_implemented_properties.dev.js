'use strict';

var fs = require('fs');

var path = require('path');

var t = require('babel-types');

var generate = require('babel-generator')["default"];

var camelToDashed = require('../lib/parsers').camelToDashed;

var dashedProperties = fs.readdirSync(path.resolve(__dirname, '../lib/properties')).filter(function (propertyFile) {
  return propertyFile.substr(-3) === '.js';
}).map(function (propertyFile) {
  return camelToDashed(propertyFile.replace('.js', ''));
});
var out_file = fs.createWriteStream(path.resolve(__dirname, '../lib/implementedProperties.js'), {
  encoding: 'utf-8'
});
var date_today = new Date();
out_file.write("'use strict';\n\n// autogenerated - " + (date_today.getMonth() + 1 + '/' + date_today.getDate() + '/' + date_today.getFullYear()) + '\n\n');
out_file.write('/*\n *\n * https://www.w3.org/Style/CSS/all-properties.en.html\n */\n\n');
var statements = [];
statements.push(t.variableDeclaration('var', [t.variableDeclarator(t.identifier('implementedProperties'), t.newExpression(t.identifier('Set'), []))]));
dashedProperties.forEach(function (property) {
  statements.push(t.expressionStatement(t.callExpression(t.memberExpression(t.identifier('implementedProperties'), t.identifier('add')), [t.stringLiteral(property)])));
});
statements.push(t.expressionStatement(t.assignmentExpression('=', t.memberExpression(t.identifier('module'), t.identifier('exports')), t.identifier('implementedProperties'))));
out_file.write(generate(t.program(statements)).code + '\n');
out_file.end(function (err) {
  if (err) {
    throw err;
  }
});