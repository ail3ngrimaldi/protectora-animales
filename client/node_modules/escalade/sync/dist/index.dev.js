"use strict";

var _require = require('path'),
    dirname = _require.dirname,
    resolve = _require.resolve;

var _require2 = require('fs'),
    readdirSync = _require2.readdirSync,
    statSync = _require2.statSync;

module.exports = function (start, callback) {
  var dir = resolve('.', start);
  var tmp,
      stats = statSync(dir);

  if (!stats.isDirectory()) {
    dir = dirname(dir);
  }

  while (true) {
    tmp = callback(dir, readdirSync(dir));
    if (tmp) return resolve(dir, tmp);
    dir = dirname(tmp = dir);
    if (tmp === dir) break;
  }
};